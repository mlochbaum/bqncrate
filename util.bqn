#! /usr/bin/env bqn

SplitTSV â† >(@+9)âŠ¸=âŠ¸(Ã—âˆ˜â†•âˆ˜â‰ âŠ¸(â†“Â¨)+`âŠ¸âŠ”)Â¨
JoinTSV â† (<1â†“âˆ¾)Ë˜ (@+9)âŠ¸âˆ¾Â¨
_onTSV â† {JoinTSVâˆ˜ğ”½âˆ˜SplitTSV}
_file â† { ğ•© â€¢FLines ğ”½ _onTSV â€¢FLines ğ•© }

Reorder â† {ğ•Št:
  letters â† "Â¯_"âˆ¾âˆ¾"0aA"+âŸœâ†•Â¨10â€¿26â€¿26
  chars â† " +-Ã—âˆ§âˆ¨âŒˆâŒŠÃ·=â‰ <>â‰¤â‰¥Â¬Â»Â«â‹ˆâˆ¾â‰â€¿(){}â‰¡â‰¢â†•|ğ•©ğ•¨â†“â†‘âŒ½âŠ¢âŠ£ËœË˜Â¨/âŠâŠ‘â¥ŠâŠ”âˆ˜âŠ¸âŸœâ—‹âŒ¾â¼âŒœÂ´Ë`Ë™âŸ¨âŸ©[]â‹†âˆšâˆŠâŠâ‰âŠ˜âŸâ—¶ğ”½ğ”¾â‹â’âŠ’â·â‰âš‡!âŠ@â‹„,â†â‡â†©ğ•—ğ•˜ğ•ğ•ğ•Šğ•¤ğ•£:;#0123456789_XYZMNIJABCDEFGHIJKLMNOPQRSTUVWXYZfghasvmabcdefghijklmnopqrstuvwxyz"

  [syntax,class] â† ("SYNTAX"â€¿"CLASS"âŠËœâŠt) âŠ â‰1â†“t
  order â† â‹â‰[
    "Primitive"â€¿"Syntax"â€¿"System" âŠ class
    (â‰ âˆ¾Â·âˆ¨charsâŠ¸âŠ)âˆ˜(Â¬âˆ˜âˆŠ/âŠ£)âŸœ(" "âˆ¾letters)Â¨ syntax
    charsâŠ¸âŠÂ¨ syntax
  ]
  t âŠËœ 0âˆ¾1+order
}

TrimKeywords â† {ğ•Št:
  Sp â† {
    ğ•Šâ¼: 1â†“âˆ¾" "âŠ¸âˆ¾Â¨ğ•© ;
    ğ•Š : (1-Ëœ(âŠ¢Ã—1+`Â»âŠ¸>)' 'â‰ ğ•©) âŠ” ğ•©
  }
  ToLower â† +âŸœ(32Ã—'A'âŠ¸â‰¤âˆ§â‰¤âŸœ'Z')
  Trim â† { ğ•© /Ëœ 1â‰¥+ËË˜ ğ•© +Â´âˆ˜â·âŒœâ—‹ToLower ğ•¨âˆ¾ğ•© }
  {(Â¯1â†“ğ•©)âŠ¸Trimâˆ˜â·âŒ¾SpâŒ¾(Â¯1âŠ¸âŠ‘) ğ•©}Ë˜ t
}

[opts,acts] â† â‰[
  "reorder"â€¿{Reorder _file ğ•©}
  "showdup"â€¿{â€¢OutÂ¨ (Â¬âˆ˜(âˆŠâˆ§âˆŠâŒ¾âŒ½)âŠË˜)âŠ¸/ _onTSV â€¢FLines ğ•©}
  "showcat"â€¿{â€¢Show âˆ¨ (/â¼âˆ˜âŠâ‰Ë˜â·) ((â‰1âŠ¸â†“) âŠËœ Â·âŠ‘âŠâŠâŸ¨"CATEGORY"âŸ©Ë™) SplitTSV â€¢FLines ğ•©}
  "trimkey"â€¿{TrimKeywords _file ğ•©}
]

{ğ•"table.tsv"} (optsâŠ¸âŠâŒ¾< âŠ‘â€¢args) âŠ‘ actsâˆ¾âŸ¨{ğ•¤â‹„0!Ëœ"Option not found!"}âŸ©
